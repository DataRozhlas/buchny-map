<!DOCTYPE html>
<meta charset="UTF-8">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div id="buchny" style="min-height: 350px;"></div>



<script type="text/javascript">
    function formatStreets(feature, layer) {
        if (feature.properties && feature.properties.Nazev) {
            layer.bindPopup('<b>' + feature.properties.Nazev + '</b><br>nalezených stříkaček v roce 2017: <b>' + feature.properties.buchny_2 + '</b>')
        }
    };

    function getColor(v) {
        return v > 104 ? '#a50f15' :
               v > 51 ? '#de2d26' :
               v > 23  ? '#fb6a4a' :
               v > 6  ? '#fcae91' :
                         '#fee5d9';
    }

    function styleStreets(feature) {
        return {
            color: getColor(feature.properties.buchny_2),
            weight: 2,
            opacity: 1
        };
    };

    function styleSquares(feature) {
        return {
            fillColor: getColor(feature.properties.buchny_2),
            weight: 1,
            color: 'lightgray',
            fillOpacity: 0.8,
            opacity: 1
        };
    };

    var map = L.map('buchny').setView([49.2002211, 16.6078411], 12);
    map.scrollWheelZoom.disable()
    L.tileLayer('https://samizdat.cz/tiles/ton_b1/{z}/{x}/{y}.png', {
        attribution: 'mapová data © přispěvatelé <a target="_blank" href="http://osm.org">OpenStreetMap</a>, obrazový podkres <a target="_blank" href="http://stamen.com">Stamen</a>, <a target="_blank" href="https://samizdat.cz">Samizdat</a>',
        maxZoom: 16,
    }).addTo(map);

    $.getJSON("https://dev.datarozhlas.cz/buchny-map/data/ul.json", function(data) {
        L.geoJSON(data, {
            onEachFeature: formatStreets,
            style: styleStreets
        }).addTo(map);
    });

    $.getJSON("https://dev.datarozhlas.cz/buchny-map/data/nam.json", function(data) {
        L.geoJSON(data, {
            onEachFeature: formatStreets,
            style: styleSquares
        }).addTo(map);
    });

    L.tileLayer('https://samizdat.cz/tiles/ton_l2/{z}/{x}/{y}.png', {
        maxZoom: 16,
    }).addTo(map);
</script>
